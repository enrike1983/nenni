{% extends 'SonataAdminBundle:CRUD:base_list.html.twig' %}

{% block list_table %}
    {{ parent() }}

    <script src="{{ asset('bundles/fosjsrouting/js/router.js') }}"></script>
    <script src="{{ path('fos_js_routing_js', { callback: 'fos.Router.setData' }) }}"></script>
    <script src="{{ asset('vendor/dragula.min.js') }}"></script>
    <script>
        dragula([document.getElementsByTagName('tbody')[0]])
        // .on('drag', function (el) {
        //   el.className = el.className.replace('ex-moved', '');
        // })
        .on('drop', function (el) {

          var ids = [];
          $.each($('.sonata-ba-list tbody tr'), function(key, value) {
              ids.push($(value).find('td').attr('objectid'));
          });

          $.post( Routing.generate('update_elements_sort'), {
              ids: ids.join(","),
              object_class: 'AppBundle:MenuItem'
          });
        });
    </script>
    {#<script src="{{ asset('admin/admin.js') }}"></script>#}
{% endblock %}

{% block stylesheets %}
    {{ parent() }}
    <link rel="stylesheet" href="{{ asset('vendor/dragula.min.css') }}">
{% endblock %}